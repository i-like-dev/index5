<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>步行貓團隊：門禁系統</title>
  <style>
    /* ... [原有的 CSS 樣式] ... */
  </style>
</head>
<body>
  <input type="button" value="管理介面" onclick="location.href='unlock-1.html'">
  <input type="text" id="textInput" placeholder="請感應磁扣">
  <div id="outputText"></div>

  <div id="adminPanel">
    <h2>管理後台</h2>
    <button id="clearButton">清除日誌</button>
    <ul id="logList"></ul>
  </div>

  <script>
    document.getElementById('textInput').addEventListener('keydown', function (event) {
      if (event.key === 'Enter') {
        var inputText = this.value.trim().toLowerCase();

        if (inputText === 'open') {
          window.open('https://i-like-dev.github.io/wrong/open.html', '_blank');
          return;
        }

        var voiceMap = {
          '0001692131': '驗證成功，歡迎進入，您使用的方式為門禁卡，帳號為「步行貓」',
          '0011107948': '驗證成功，歡迎進入，您使用的方式為門禁卡，帳號為四樓通用',
          '2952721155': '訪客用卡申請與識別成功，請進入',
        };

        if (voiceMap.hasOwnProperty(inputText)) {
          var voiceText = voiceMap[inputText];
          var synth = window.speechSynthesis;
          var utterance = new SpeechSynthesisUtterance(voiceText);
          var outputText = document.getElementById('outputText');
          outputText.innerText = voiceText;

          utterance.onend = function () {
            outputText.innerText = '';
          };

          synth.speak(utterance);
          updateAdminPanel(inputText);
        } else {
          alert('找不到該筆資料');
        }

        this.value = '';
      }
    });

    function updateAdminPanel(user) {
      var logList = document.getElementById('logList');
      var logItem = document.createElement('li');
      logItem.className = 'logItem';
      logItem.innerText = user + ' 在 ' + getCurrentTime() + ' 感應他的卡';
      logList.insertBefore(logItem, logList.firstChild);

      saveLogToLocalStorage(logItem.innerText);
    }

    document.getElementById('clearButton').addEventListener('click', function () {
      var logList = document.getElementById('logList');
      logList.innerHTML = '';
      localStorage.removeItem('logs');
    });

    function saveLogToLocalStorage(log) {
      var logs = localStorage.getItem('logs') ? JSON.parse(localStorage.getItem('logs')) : [];
      logs.push(log);
      localStorage.setItem('logs', JSON.stringify(logs));
    }

    function loadLogsFromLocalStorage() {
      var logs = localStorage.getItem('logs') ? JSON.parse(localStorage.getItem('logs')) : [];
      var logList = document.getElementById('logList');
      logs.forEach(function(log) {
        var logItem = document.createElement('li');
        logItem.className = 'logItem';
        logItem.innerText = log;
        logList.appendChild(logItem);
      });
    }

    function getCurrentTime() {
      var now = new Date();
      var hours = now.getHours();
      var minutes = now.getMinutes();
      var seconds = now.getSeconds();
      return hours + ':' + minutes + ':' + seconds;
    }

    loadLogsFromLocalStorage();
  </script>

  <p>請刷卡後再進入！</p>
  <p>系統提醒您，等聽到「滴....」時，即可進入</p>
</body>
</html>
